<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[Writeup] Financial Cybersecurity Bootcamp 2018 | ErbaZZ's Space</title><meta name=keywords content="ctf,writeup,competition"><meta name=description content="In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round."><meta name=author content="ErbaZZ"><link rel=canonical href=https://erbazz.me/writeup/fincybersec2018/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://erbazz.me/favicon.ico><link rel=apple-touch-icon href=https://erbazz.me/favicon.ico><link rel=mask-icon href=https://erbazz.me/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[Writeup] Financial Cybersecurity Bootcamp 2018"><meta property="og:description" content="In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round."><meta property="og:type" content="article"><meta property="og:url" content="https://erbazz.me/writeup/fincybersec2018/"><meta property="og:image" content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="writeup"><meta property="article:published_time" content="2018-11-11T02:35:49+07:00"><meta property="article:modified_time" content="2018-11-11T02:35:49+07:00"><meta property="og:site_name" content="ErbaZZ's Space"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[Writeup] Financial Cybersecurity Bootcamp 2018"><meta name=twitter:description content="In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://erbazz.me/writeup/"},{"@type":"ListItem","position":2,"name":"[Writeup] Financial Cybersecurity Bootcamp 2018","item":"https://erbazz.me/writeup/fincybersec2018/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Writeup] Financial Cybersecurity Bootcamp 2018","name":"[Writeup] Financial Cybersecurity Bootcamp 2018","description":"In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round.\n","keywords":["ctf","writeup","competition"],"articleBody":"In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round.\nFinalist Teams Announcement\nThe final round was held at the Bank of Thailand Learning Center at 27 October. The style of the competition is different from the first round, as the problems are sequential, such that you need to solve the first challenge in order to continue to the next and so on. The goal is to hack into the system of an imaginary bank called Cat Bank.\n!IsCaptured Team\nThere are a total of 5 challenges, the first one provides an NTLM hash of a bank officer with the last two characters missing. It is hinted that we should use Pass the Hash attack on the server using the given hash.\nSince there are only two characters missing, and the hash are in hexadecimal, there are only 16^2 or 256 combinations to try, in which we could easily bruteforce it. However, even though we knew bruteforcing it is a logical thing to do, we didn’t know how to do the Pass the Hash, or which tools to use. After an hour of trials and errors (and some publicly announced hints from the organizer), we successfully wrote a working Python script that bruteforces the hash and call smbclient of Impacket to connect to the address of the Windows Domain Controller given.\n1 2 3 4 5 6 7 8 9  from subprocess import call h = \"2d3c0049f15843dd77a999a314b192\" charList = \"0123456789abcdef\" for i in range (0, len(list)): for j in range (0, len(list)): fullHash = h + charList[i] + charList[j] print(fullHash) call([\"./smbclient.py\", \"ccbankad.p7z.pw/bankofficer2@13.251.114.118\", \"-hashes\" , \":\"+fullHash])   With the script, in less than a minute, we were able to access the domain controller using one of the back officers account.\nConnected to the Domain Controller\nSince we had zero experience interacting with this type of server, we just run help as it suggested to see the list of all available commands.\nAnd of course, we used ls to list the current directory, but it responded with “[-] No share selected”, so we tried shares.\nTrying out the commands\nWe could see 7 different share names, and the most suspicious one is financial_reports, so we accessed the share with use financial_reports and ls again.\nAccessing the share\nHere, we could see an xlsx file, so we downloaded it using get confidential_2.xlsx and opened it, revealing the flag and another user account to continue with the next challenge.\nExcel file containing the flag\nThe next challenge tells us that “The system administrator really loves Linux, but his boss has ordered him to use Windows Server. Therefore, he made a hidden way to access his server like Linux”.\nFor this, we started by using nmap to do the default scan, but to no avails, nothing interesting appeared. Therefore, we decided to use nmap to do service scan to scan the whole thing starting from port 1. After a long wait, we finally found something interesting.\nNmap port scanning result\nWe could see that there is an open port with OpenSSH on it, which could be the admin’s hidden “Linux way” to access the server. Using the provided credential from the last challenge, we used ssh to connect to the server, and voila, we now have the access to the Windows command prompt.\nAfter looking around for a bit, we found a file called note.docx on the desktop of the server. We then used WinSCP to download the file from the server and opened it.\nThis is what we have found:\nnote.docx\nYes, an empty Microsoft Word file… or is it?\nHighlighting the content\nFlag :)\nAnd this is the furthest we could go before the end of the competition. Surprisingly, even though most teams passed the second challenge, we were faster than most and won as the Second Runner-up.\n!IsCaptured winning Second Runner-up\nThis is our first time participating in a on-site CTF competition, and the first time to work on a sequential CTF challenges. It was a fun and memorable experience. I have learned a lot, and there are still much more interesting things for me to learn!\n","wordCount":"725","inLanguage":"en","datePublished":"2018-11-11T02:35:49+07:00","dateModified":"2018-11-11T02:35:49+07:00","author":{"@type":"Person","name":"ErbaZZ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://erbazz.me/writeup/fincybersec2018/"},"publisher":{"@type":"Organization","name":"ErbaZZ's Space","logo":{"@type":"ImageObject","url":"https://erbazz.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://erbazz.me/ accesskey=h title="ErbaZZ's Space (Alt + H)"><img src=https://erbazz.me/apple-touch-icon.png alt aria-label=logo height=35>ErbaZZ's Space</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://erbazz.me/ title=Home><span>Home</span></a></li><li><a href=https://erbazz.me/writeup/ title=Writeup><span>Writeup</span></a></li><li><a href=https://erbazz.me/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://erbazz.me/>Home</a>&nbsp;»&nbsp;<a href=https://erbazz.me/writeup/>Writeups</a></div><h1 class=post-title>[Writeup] Financial Cybersecurity Bootcamp 2018</h1><div class=post-meta><span title="2018-11-11 02:35:49 +0700 +07">November 11, 2018</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;725 words&nbsp;·&nbsp;ErbaZZ</div></header><div class=post-content><p>In August, I had a chance to participate in an online CTF competition called Financial Cybersecurity Bootcamp 2018, which is a jeopardy style competition with the time limit of 24 hours. Together with my team, !IsCaptured, we solved 4 of the challenges and became eligible to participate in the final round.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_finalists.jpg alt="Finalist Teams">
<em>Finalist Teams Announcement</em></p><p>The final round was held at the Bank of Thailand Learning Center at 27 October. The style of the competition is different from the first round, as the problems are sequential, such that you need to solve the first challenge in order to continue to the next and so on. The goal is to hack into the system of an imaginary bank called <strong>Cat Bank</strong>.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_team.jpg alt=!IsCaptured>
<em>!IsCaptured Team</em></p><p>There are a total of 5 challenges, the first one provides an NTLM hash of a bank officer with the last two characters missing. It is hinted that we should use Pass the Hash attack on the server using the given hash.</p><p>Since there are only two characters missing, and the hash are in hexadecimal, there are only 16^2 or 256 combinations to try, in which we could easily bruteforce it. However, even though we knew bruteforcing it is a logical thing to do, we didn&rsquo;t know how to do the Pass the Hash, or which tools to use. After an hour of trials and errors (and some publicly announced hints from the organizer), we successfully wrote a working Python script that bruteforces the hash and call smbclient of Impacket to connect to the address of the Windows Domain Controller given.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>subprocess</span> <span class=kn>import</span> <span class=n>call</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>h</span> <span class=o>=</span> <span class=s2>&#34;2d3c0049f15843dd77a999a314b192&#34;</span>
</span></span><span class=line><span class=cl><span class=n>charList</span> <span class=o>=</span> <span class=s2>&#34;0123456789abcdef&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nb>list</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=nb>list</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>fullHash</span> <span class=o>=</span> <span class=n>h</span> <span class=o>+</span> <span class=n>charList</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>charList</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>fullHash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>call</span><span class=p>([</span><span class=s2>&#34;./smbclient.py&#34;</span><span class=p>,</span> <span class=s2>&#34;ccbankad.p7z.pw/bankofficer2@13.251.114.118&#34;</span><span class=p>,</span> <span class=s2>&#34;-hashes&#34;</span> <span class=p>,</span> <span class=s2>&#34;:&#34;</span><span class=o>+</span><span class=n>fullHash</span><span class=p>])</span></span></span></code></pre></td></tr></table></div></div><p>With the script, in less than a minute, we were able to access the domain controller using one of the back officers account.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_1_1.png alt="Domain Controller Terminal">
<em>Connected to the Domain Controller</em></p><p>Since we had zero experience interacting with this type of server, we just run <strong>help</strong> as it suggested to see the list of all available commands.</p><p>And of course, we used <strong>ls</strong> to list the current directory, but it responded with &ldquo;[-] No share selected&rdquo;, so we tried <strong>shares</strong>.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_1_2.png alt="Trying out the commands">
<em>Trying out the commands</em></p><p>We could see 7 different share names, and the most suspicious one is <strong>financial_reports</strong>, so we accessed the share with <strong>use financial_reports</strong> and <strong>ls</strong> again.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_1_3.png alt="Accessing the share">
<em>Accessing the share</em></p><p>Here, we could see an xlsx file, so we downloaded it using <strong>get confidential_2.xlsx</strong> and opened it, revealing the flag and another user account to continue with the next challenge.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_1_flag.png alt="Excel file containing the flag">
<em>Excel file containing the flag</em></p><p>The next challenge tells us that &ldquo;The system administrator really loves Linux, but his boss has ordered him to use Windows Server. Therefore, he made a hidden way to access his server like Linux&rdquo;.</p><p>For this, we started by using nmap to do the default scan, but to no avails, nothing interesting appeared. Therefore, we decided to use nmap to do service scan to scan the whole thing starting from port 1. After a long wait, we finally found something interesting.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_2_1.png alt="Nmap port scanning result">
<em>Nmap port scanning result</em></p><p>We could see that there is an open port with OpenSSH on it, which could be the admin&rsquo;s hidden &ldquo;Linux way&rdquo; to access the server. Using the provided credential from the last challenge, we used ssh to connect to the server, and voila, we now have the access to the Windows command prompt.</p><p>After looking around for a bit, we found a file called <em>note.docx</em> on the desktop of the server. We then used WinSCP to download the file from the server and opened it.</p><p>This is what we have found:</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_2_2.png alt=note.docx>
<em>note.docx</em></p><p>Yes, an empty Microsoft Word file&mldr; or is it?</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_2_3.png alt="Highlighting the content">
<em>Highlighting the content</em></p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_2_flag.png alt="Flag :)">
<em>Flag :)</em></p><p>And this is the furthest we could go before the end of the competition. Surprisingly, even though most teams passed the second challenge, we were faster than most and won as the Second Runner-up.</p><p><img loading=lazy src=/images/fincybersec2018/fincybersec2018_3rdplace.jpg alt="Second Runner-up">
<em>!IsCaptured winning Second Runner-up</em></p><p>This is our first time participating in a on-site CTF competition, and the first time to work on a sequential CTF challenges. It was a fun and memorable experience. I have learned a lot, and there are still much more interesting things for me to learn!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://erbazz.me/tags/ctf/>ctf</a></li><li><a href=https://erbazz.me/tags/writeup/>writeup</a></li><li><a href=https://erbazz.me/tags/competition/>competition</a></li></ul><nav class=paginav><a class=prev href=https://erbazz.me/writeup/hackingcontest2019/><span class=title>« Prev</span><br><span>[Writeup] Hacking Contest 2019 (Qualification Round)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://erbazz.me/>ErbaZZ's Space</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>